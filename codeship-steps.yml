- name: run test
  service: typo3_test
  command: bash -c "cd /opt/typo3; vendor/bin/phpunit --color -c web/typo3conf/ext/sh_scoutnet_webservice/Tests/Builds/UnitTests.xml"

- name: run php lint
  service: typo3_test
  command: bash -c "cd /opt/typo3/web/typo3conf/ext/sh_scoutnet_webservice; find . -name \*.php | parallel --gnu php -d display_errors=stderr -l {} > /dev/null"

- name: check_version
  tag: ^[0-9]+[.][0-9]+[.][0-9]+$
  service: build_host
  command: bash -c "cd /opt/data; make checkVersion"

- name: release to Github
  tag: ^[0-9]+[.][0-9]+[.][0-9]+$
  service: build_host
  command: bash -c "cd /opt/data; make release"

- name: build
  tag: ^[0-9]+[.][0-9]+[.][0-9]+$
  service: build_host
  command: bash -c "cd /opt/data; make deploy"

